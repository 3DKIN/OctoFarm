!function e(t,n,r){function a(i,c){if(!n[i]){if(!t[i]){var s="function"==typeof require&&require;if(!c&&s)return s(i,!0);if(o)return o(i,!0);var l=new Error("Cannot find module '"+i+"'");throw l.code="MODULE_NOT_FOUND",l}var u=n[i]={exports:{}};t[i][0].call(u.exports,(function(e){return a(t[i][1][e]||e)}),u,u.exports,e,t,n,r)}return n[i].exports}for(var o="function"==typeof require&&require,i=0;i<r.length;i++)a(r[i]);return a}({1:[function(e,t,n){"use strict";var r=o(e("./lib/functions/calc.js")),a=o(e("./lib/modules/currentOperations.js"));function o(e){return e&&e.__esModule?e:{default:e}}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var c,s,l,u,d,f={chart:{type:"line",id:"realtime",width:"100%",height:"90%",animations:{enabled:!1},toolbar:{show:!1},zoom:{enabled:!1},background:"#303030"},colors:["#fcc329","#ff1500","#009cff","#ff1800","#37ff00","#ff1800"],stroke:{curve:"smooth"},toolbar:{show:!1},theme:{mode:"dark"},noData:{text:"Loading..."},series:[],yaxis:[{title:{text:"Temp"},seriesName:"Actual Tool",labels:{formatter:function(e){return"".concat(e,"°C")}}},{seriesName:"Actual Tool",show:!1,labels:{formatter:function(e){return"".concat(e,"°C")}}},{seriesName:"Actual Tool",show:!1,labels:{formatter:function(e){return"".concat(e,"°C")}}},{seriesName:"Actual Tool",show:!1,labels:{formatter:function(e){return"".concat(e,"°C")}}},{seriesName:"Actual Tool",show:!1,labels:{formatter:function(e){return"".concat(e,"°C")}}},{seriesName:"Actual Tool",show:!1,labels:{formatter:function(e){return"".concat(e,"°C")}}}],xaxis:{type:"datetime",labels:{formatter:function(e){return new Date(e).toLocaleTimeString()}}}},m={chart:{type:"heatmap",id:"realtime",width:"100%",height:"90%",animations:{enabled:!0,easing:"linear",dynamicAnimation:{speed:1e3}},toolbar:{show:!1},zoom:{enabled:!1},background:"#303030"},theme:{mode:"dark"},noData:{text:"Loading..."},series:[],dataLabels:{enabled:!0,formatter:function(e){return"".concat(Math.round(10*e)/10,"%")},style:{fontSize:"14px",fontFamily:"Helvetica, Arial, sans-serif",fontWeight:"bold",colors:["#000000"]}},stroke:{show:!0,curve:"smooth",lineCap:"butt",colors:["#303030"],width:2,dashArray:0},plotOptions:{heatmap:{shadeIntensity:.7,radius:0,useFillColorAsStroke:!1,colorScale:{ranges:[{from:0,to:1,name:"none",color:"#444"},{from:1.1,to:25,name:"low",color:"#375a7f"},{from:25.1,to:60,name:"medium",color:"#f39c12"},{from:60.1,to:75,name:"high",color:"#00bc8c"},{from:75.1,to:100,name:"extreme",color:"#e74c3c"}]}}},tooltip:{y:{formatter:function(e){return"".concat(Math.round(10*e)/10,"%")}}},xaxis:{reversed:!0}},p={chart:{type:"donut",width:"100%",height:"100%",animations:{enabled:!0},background:"#303030"},theme:{mode:"dark"},plotOptions:{pie:{expandOnClick:!1,dataLabels:{offset:10,minAngleToShowLabel:15}}},stroke:{show:!1},tooltip:{y:{formatter:function(e){return"".concat(Math.round(10*e)/10,"%")}}},noData:{text:"Loading..."},dataLabels:{enabled:!1},series:[],labels:["Active","Idle","Offline"],colors:["#00bc8c","#444","#e74c3c"],legend:{show:!0,showForSingleSeries:!1,showForNullSeries:!0,showForZeroSeries:!0,position:"bottom",horizontalAlign:"center",floating:!1,fontSize:"11px",fontFamily:"Helvetica, Arial",fontWeight:400,formatter:void 0,inverseOrder:!1,width:void 0,height:void 0,tooltipHoverFormatter:void 0,offsetX:-25,offsetY:0,labels:{colors:void 0,useSeriesColors:!1},markers:{width:9,height:9,strokeWidth:0,strokeColor:"#fff",fillColors:void 0,radius:1,customHTML:void 0,onClick:void 0,offsetX:0,offsetY:0},itemMargin:{horizontal:1,vertical:0},onItemClick:{toggleDataSeries:!1},onItemHover:{highlightDataSeries:!1}}},y={chart:{type:"line",id:"realtime",height:"90%",width:"100%",animations:{enabled:!1},toolbar:{show:!1},zoom:{enabled:!1},background:"#303030"},colors:["#ff1500","#324bca","#caa932","#49ca32"],stroke:{curve:"smooth"},toolbar:{show:!0},theme:{mode:"dark"},noData:{text:"Loading..."},series:[],yaxis:[{title:{text:"Temp"},seriesName:"Temperature",labels:{formatter:function(e){return null===e?"":"".concat(e,"°C")}},min:0,max:45},{title:{text:"Humidity"},opposite:!0,seriesName:"Humidity",show:!0,labels:{formatter:function(e){return null===e?"":"".concat(e," %")}},min:0,max:100},{title:{text:"Pressure"},opposite:!0,seriesName:"Pressure",show:!0,labels:{formatter:function(e){return null===e?"":"".concat(e," Pa")}},min:0,max:1100},{title:{text:"Indoor Air Quality"},opposite:!1,seriesName:"IAQ",show:!0,min:0,max:500,labels:{formatter:function(e){var t=null;return null===e?"":(r.default.isBetween(e,0,50)&&(t="Excellent"),r.default.isBetween(e,51,100)&&(t="Good"),r.default.isBetween(e,101,150)&&(t="Lightly Polluted"),r.default.isBetween(e,151,200)&&(t="Moderately Polluted"),r.default.isBetween(e,201,250)&&(t="Heavily Polluted"),r.default.isBetween(e,251,350)&&(t="Severely Polluted"),r.default.isBetween(e,350,500)&&(t="Extremely Polluted"),"".concat(e,": ").concat(t))}}}],xaxis:{type:"datetime",labels:{formatter:function(e){return new Date(e).toLocaleTimeString()}}},annotations:{position:"front",yaxis:[{y:0,y2:50,yAxisIndex:3,borderColor:"#24571f",fillColor:"#133614"},{y:51,y2:100,yAxisIndex:3,borderColor:"#457a24",fillColor:"#31561a"},{y:101,y2:150,yAxisIndex:3,borderColor:"#7a6f24",fillColor:"#564f1a"},{y:151,y2:200,yAxisIndex:3,borderColor:"#5c3421",fillColor:"#3b3015"},{y:201,y2:250,yAxisIndex:3,borderColor:"#5c2121",fillColor:"#3b1515"},{y:251,y2:350,yAxisIndex:3,borderColor:"#37215c",fillColor:"#23153b"},{y:350,yAxisIndex:3,borderColor:"#280000",fillColor:"#000000"}]}};document.querySelector("#enviromentalHistory")&&(c=new ApexCharts(document.querySelector("#enviromentalHistory"),y)).render(),document.querySelector("#farmTempMap")&&(s=new ApexCharts(document.querySelector("#farmTempMap"),f)).render(),document.querySelector("#daysActivityHeatMap")&&(l=new ApexCharts(document.querySelector("#daysActivityHeatMap"),m)).render(),document.querySelector("#currentActivity")&&(u=new ApexCharts(document.querySelector("#currentActivity"),{series:[],chart:{type:"bar",width:"100%",height:"85%",toolbar:{show:!1},animations:{enabled:!1},background:"#303030"},theme:{mode:"dark"},plotOptions:{bar:{horizontal:!0}},noData:{text:"Loading..."},dataLabels:{enabled:!1,formatter:function(e){return e}},xaxis:{categories:["Active","Complete","Idle","Disconnected","Offline"]},tooltip:{theme:"dark",x:{show:!1},y:{title:{formatter:function(e,t){return"".concat(t.w.globals.labels[t.dataPointIndex],":  ")}}}}})).render(),document.querySelector("#currentUtilisation")&&(d=new ApexCharts(document.querySelector("#currentUtilisation"),p)).render();var g=null;if(window.Worker)try{null===g&&((g=new Worker("/assets/js/workers/dashboardWorker.min.js")).onmessage=function(e){if(0!=e.data){var t=e.data.currentOperations,n=e.data.printerInformation,r=e.data.dashStatistics,o=e.data.dashboardSettings;o.farmActivity.currentOperations&&(0,a.default)(t.operations,t.count,n),v.farmInformation(r.timeEstimates,r.utilisationGraph,r.temperatureGraph,o),o.farmUtilisation.farmUtilisation&&v.farmUtilisation(r.farmUtilisation),v.currentActivity(r.currentStatus,r.currentUtilisation,o.printerStates.currentStatus,o.farmUtilisation.currentUtilisation),o.printerStates.printerState&&v.printerStatus(r.printerHeatMaps.heatStatus),o.printerStates.printerProgress&&v.printerProgress(r.printerHeatMaps.heatProgress),o.printerStates.printerTemps&&v.printerTemps(r.printerHeatMaps.heatTemps),o.printerStates.printerUtilisation&&v.printerUptime(r.printerHeatMaps.heatUtilisation),o.historical.environmentalHistory&&v.envriromentalData(r.enviromentalData)}})}catch(e){console.log(e)}else console.log("Web workers not available... sorry!");var v=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,a;return t=e,a=[{key:"envriromentalData",value:function(e){c.updateSeries(e);var t=null,n="",a="",o=document.getElementById("indoorAirQualityAlert");if(e[3].data.length>0){var i=e[3].data[e[3].data.length-1].y;o.classList.contains("d-none")&&o.classList.remove("d-none"),r.default.isBetween(i,0,50)&&(t='<i class="fas fa-check-circle textComplete"></i> Excellent',n="Pure air; best for well-being",a=""),r.default.isBetween(i,51,100)&&(t='<i class="fas fa-check-circle"></i> Good',n="No irritation or impact on well-being",a=""),r.default.isBetween(i,101,150)&&(t='<i class="fas fa-exclamation-triangle"></i>  Lightly Polluted',n="Reduction of well-being possible",a="Ventilation suggested"),r.default.isBetween(i,151,200)&&(t='<i class="fas fa-exclamation-triangle"></i>  Moderately Polluted',n="More significant irritation possible",a="Increase ventilation with clean air"),r.default.isBetween(i,201,250)&&(t='<i class="fas fa-exclamation-triangle"></i>  Heavily Polluted',n="Exposition might lead to effects like headache depending on type of VOCs",a="Optimize ventilation"),r.default.isBetween(i,251,350)&&(t='<i class="fas fa-exclamation-triangle"></i>  Severely Polluted',n="More severe health issue possible if harmful VOC present",a="Contamination should be identified if level is reached even w/o presence of people; maximize ventilation & reduce attendance"),r.default.isBetween(i,350,500)&&(t='<i class="fas fa-exclamation-triangle"></i>  Extremely Polluted',n="Headaches, additional neurotoxic effects possible",a="Contamination needs to be identified; avoid presence in room and maximize ventilation"),o.innerHTML="Indoor Air Quality: ".concat(i," ").concat(t),o.title="".concat(n,": ").concat(a)}}},{key:"printerStatus",value:function(e){var t=document.getElementById("currentStatus");t.innerHTML="";for(var n=0;n<e.length;n++)t.insertAdjacentHTML("beforeend",e[n])}},{key:"printerProgress",value:function(e){var t=document.getElementById("currentProgress");t.innerHTML="";for(var n=0;n<e.length;n++)t.insertAdjacentHTML("beforeend",e[n])}},{key:"printerTemps",value:function(e){var t=document.getElementById("currentTemps");t.innerHTML="";for(var n=0;n<e.length;n++)t.insertAdjacentHTML("beforeend",e[n])}},{key:"printerUptime",value:function(e){var t=document.getElementById("currentUptime");t.innerHTML="";for(var n=0;n<e.length;n++)t.insertAdjacentHTML("beforeend",e[n])}},{key:"farmInformation",value:function(e,t,n,a){a.farmActivity.averageTimes&&(document.getElementById("avgEstimatedTime").innerHTML=r.default.generateTime(e.averageEstimated),document.getElementById("avgRemainingTime").innerHTML=r.default.generateTime(e.averageRemaining),document.getElementById("avgElapsedTime").innerHTML=r.default.generateTime(e.averageElapsed),avgRemainingProgress.style.width="".concat(r.default.toFixed(e.averagePercentRemaining,2),"%"),avgRemainingProgress.innerHTML="".concat(r.default.toFixed(e.averagePercentRemaining,2),"%"),avgElapsed.style.width="".concat(r.default.toFixed(e.averagePercent,2),"%"),avgElapsed.innerHTML="".concat(r.default.toFixed(e.averagePercent,2),"%")),a.farmActivity.cumulativeTimes&&(document.getElementById("cumEstimatedTime").innerHTML=r.default.generateTime(e.totalEstimated),document.getElementById("cumRemainingTime").innerHTML=r.default.generateTime(e.totalRemaining),document.getElementById("cumElapsedTime").innerHTML=r.default.generateTime(e.totalElapsed),cumRemainingProgress.style.width="".concat(r.default.toFixed(e.cumulativePercentRemaining,2),"%"),cumRemainingProgress.innerHTML="".concat(r.default.toFixed(e.cumulativePercentRemaining,2),"%"),cumElapsed.style.width="".concat(r.default.toFixed(e.cumulativePercent,2),"%"),cumElapsed.innerHTML="".concat(r.default.toFixed(e.cumulativePercent,2),"%")),a.historical.hourlyTotalTemperatures&&(s.updateSeries(n),document.getElementById("globalTemp").innerHTML='\n            <i class="fas fa-temperature-high"></i> Total Temperature: '.concat(r.default.toFixed(e.totalFarmTemp,0)," °C\n             ")),a.historical.weeklyUtilisation&&l.updateSeries(t)}},{key:"currentActivity",value:function(e,t,n,r){r&&d.updateSeries(e),n&&u.updateSeries(t)}},{key:"farmUtilisation",value:function(e){document.getElementById("activeHours").innerHTML='<i class="fas fa-square text-success"></i> <b>Active: </b> '.concat(r.default.generateTime(e.activeHours/1e3)),document.getElementById("idleHours").innerHTML='<i class="fas fa-square text-secondary"></i> <b>Idle Hours: </b> '.concat(r.default.generateTime(e.idleHours/1e3)),document.getElementById("failedHours").innerHTML='<i class="fas fa-square text-warning"></i> <b>Failed Hours: </b>'.concat(r.default.generateTime(e.failedHours/1e3)),document.getElementById("offlineHours").innerHTML='<i class="fas fa-square text-danger"></i> <b>Offline Hours: </b>'.concat(r.default.generateTime(e.offlineHours/1e3));var t=document.getElementById("activeProgress");t.style.width="".concat(r.default.toFixed(e.activeHoursPercent,0),"%"),t.innerHTML="".concat(r.default.toFixed(e.activeHoursPercent,0),"%");var n=document.getElementById("idleProgress");n.style.width="".concat(r.default.toFixed(e.idleHoursPercent,0),"%"),n.innerHTML="".concat(r.default.toFixed(e.idleHoursPercent,0),"%");var a=document.getElementById("failedProgress");a.style.width="".concat(r.default.toFixed(e.failedHoursPercent,0),"%"),a.innerHTML="".concat(r.default.toFixed(e.failedHoursPercent,0),"%");var o=document.getElementById("offlineProgress");o.style.width="".concat(r.default.toFixed(e.offlineHoursPercent,0),"%"),o.innerHTML="".concat(r.default.toFixed(e.offlineHoursPercent,0),"%")}}],(n=null)&&i(t.prototype,n),a&&i(t,a),e}(),h=GridStack.init({animate:!0,cellHeight:30,draggable:{handle:".tag"},float:!0});!function(){var e=localStorage.getItem("dashboardConfiguration"),t=JSON.parse(e);if(null!==t&&0!==t.length){var n=GridStack.Utils.sort(t);h.batchUpdate(),h.engine.nodes.forEach((function(e){var t=n.find((function(t){return t.id===e.id}));void 0!==t&&h.update(e.el,t.x,t.y,t.width,t.height)})),h.commit()}}(),h.on("change",(function(e,t){var n;n=[],h.engine.nodes.forEach((function(e){n.push({x:e.x,y:e.y,width:e.width,height:e.height,id:e.id})})),localStorage.setItem("dashboardConfiguration",JSON.stringify(n))}))},{"./lib/functions/calc.js":2,"./lib/modules/currentOperations.js":5}],2:[function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,a;return t=e,a=[{key:"randomString",value:function(){return Math.random().toString(36).substr(2,5)}},{key:"toFixed",value:function(e,t){return null!=e?e.toFixed(t):0}},{key:"generateTime",value:function(e){var t="";if(void 0===e||isNaN(e)||null===e)t="No Time Estimate";else{Math.floor(e/131400);var n=Math.floor(e/86400);e-=3600*n*24;var r=Math.floor(e/3600);e-=3600*r;var a=Math.floor(e/60);e-=60*a,e=Math.floor(e),t="".concat(n,"d, ").concat(r,"h, ").concat(a,"m, ").concat(e,"s"),0==a&&t.includes("0m")&&(t=t.replace(" 0m,","")),0==r&&t.includes("0h")&&(t=t.replace(" 0h,","")),0==n&&t.includes("0d")&&(t=t.replace("0d,","")),0==a&&0==r&&0==n&&0==e&&(t=t.replace("0s","Done"))}return t}},{key:"isBetween",value:function(e,t,n){return(e-t)*(e-n)<=0}},{key:"returnPrintCost",value:function(e,t){if(void 0===e)return"No cost settings to calculate from";var n=t/3600,r=parseFloat(e.powerConsumption)*parseFloat(e.electricityCosts)*n,a=parseFloat(e.purchasePrice),o=parseFloat(e.estimateLifespan);return(r+((o>0?a/o:0)+parseFloat(e.maintenanceCosts))*n).toFixed(2)}},{key:"bytes",value:function(e,t){if(void 0===e||isNaN(e)||null===e)return"No File Estimate";if(0==e)return"0 Bytes";var n=t||2,r=Math.floor(Math.log(e)/Math.log(1024));return"".concat(parseFloat((e/Math.pow(1024,r)).toFixed(n))," ").concat(["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"][r])}},{key:"dateClean",value:function(e){return e=new Date(e),"".concat(e.getFullYear(),"-").concat(e.getMonth(),"-").concat(e.getDay(),": ").concat(e.getHours(),":").concat(e.getSeconds())}}],(n=null)&&r(t.prototype,n),a&&r(t,a),e}();n.default=a},{}],3:[function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,a;return t=e,a=[{key:"getColour",value:function(e){return"Operational"===e?{name:"secondary",hex:"#262626",category:"Idle"}:"Paused"===e?{name:"warning",hex:"#583c0e",category:"Idle"}:"Printing"===e||"Pausing"===e||"Cancelling"===e?{name:"warning",hex:"#583c0e",category:"Active"}:"Error"===e?{name:"danger",hex:"#2e0905",category:"Idle"}:"Offline"===e?{name:"danger",hex:"#2e0905",category:"Offline"}:"Searching..."===e?{name:"danger",hex:"#2e0905",category:"Idle"}:"Closed"===e?{name:"danger",hex:"#2e0905",category:"Closed"}:"Complete"===e?{name:"success",hex:"#00330e",category:"Complete"}:{name:"danger",hex:"#2e0905",category:"Offline"}}},{key:"createMessage",value:function(e,t){var n=document.getElementById(t),r='\n      <div class="alert alert-'.concat(e.type,' alert-dismissible fade show" role="alert">\n        ').concat(e.msg,'\n      <button type="button" class="close" data-dismiss="alert" aria-label="Close">\n        <span aria-hidden="true">&times;</span>\n      </button>\n    </div>\n    ');n.insertAdjacentHTML("beforeend",r)}},{key:"createAlert",value:function(e,t,n,r){r=null!=r?["click"]:[],Noty.setMaxVisible(50),new Noty({type:e,theme:"bootstrap-v4",closeWith:r,timeout:n,layout:"bottomRight",text:t}).show()}},{key:"doesElementNeedUpdating",value:function(e,t,n){e!==t[n]&&(t[n]=e)}}],(n=null)&&r(t.prototype,n),a&&r(t,a),e}();n.default=a},{}],4:[function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,a;return t=e,a=[{key:"URL",value:function(e){var t;return t||(t=document.createElement("input")).setAttribute("type","url"),t.value=e,t.validity.valid}},{key:"IP",value:function(e){return!!/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/.test(e)}},{key:"JSON",value:function(e){return!!/^[\],:{}\s]*$/.test(e.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))}},{key:"getName",value:function(e){return void 0!==e.settingsAppearance?""===e.settingsAppearance.name||null===e.settingsAppearance.name?e.printerURL:e.settingsAppearance.name:e.printerURL}},{key:"stripHTML",value:function(e){var t=document.createElement("DIV");t.innerHTML=e;var n=t.textContent||t.innerText||"";return n.replace("​",""),n=n.trim()}}],(n=null)&&r(t.prototype,n),a&&r(t,a),e}();n.default=a},{}],5:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e,t,n){if(c=n,0===e.length){document.querySelectorAll("[id^='currentOpCard-']").forEach((function(e){e.remove()}))}t=t,document.getElementById("completeCount").innerHTML="Complete: "+t.complete,document.getElementById("idleCount").innerHTML="Idle: "+t.idle,document.getElementById("activeCount").innerHTML="Active: "+t.active,document.getElementById("disconCount").innerHTML="Disconnected: "+t.disconnected,document.getElementById("offlineCount").innerHTML="Offline: "+t.offline,document.getElementById("farmProgress").innerHTML=t.farmProgress+"%",document.getElementById("farmProgress").style="width: ".concat(t.farmProgress,"%"),document.getElementById("farmProgress").classList="progress-bar progress-bar-striped bg-".concat(t.farmProgressColour),(e=_.orderBy(e,["progress"],["desc"])).forEach((function(t,n){var a=new Date;a=a.getTime();var o=new Date(a+1e3*t.timeRemaining).toDateString(),c=new Date(a+1e3*t.timeRemaining).toTimeString(),u=o+": "+(c=c.substring(0,8)),d="<button id='currentHarvest-".concat(t.index,"' type='button' title=\"Clear your finished print from current operations\" class='tag btn btn-success btn-sm mt-0 pt-0 pb-0'>Print Harvested?</button>"),f="<button id='restartCurrentPrint-".concat(t.index,"' type='button' title=\"Restart your current selected print\" class='tag btn btn-warning btn-sm mt-0 pt-0 pb-0'>Restart Print</button>"),m=null;if(void 0!==i(t.fileName)&&(m=t.fileName.replace(".gcode","")).length>15&&m.substring(0,16),document.getElementById("currentOpCard-"+t.index)){100===t.progress?(document.getElementById("finishedPrint-"+t.index).classList.remove("d-none"),document.getElementById("futureDate-"+t.index).classList.add("d-none"),document.getElementById("currentRestart-"+t.index).classList.remove("d-none"),document.getElementById("currentTime-"+t.index).classList.add("d-none"),document.getElementById("currentProgressMain-"+t.index).classList.add("d-none")):(document.getElementById("finishedPrint-"+t.index).classList.add("d-none"),document.getElementById("futureDate-"+t.index).classList.remove("d-none"),document.getElementById("currentRestart-"+t.index).classList.add("d-none"),document.getElementById("currentTime-"+t.index).classList.remove("d-none"),document.getElementById("currentProgressMain-"+t.index).classList.remove("d-none"));var p=document.getElementById("currentProgress-"+t.index);document.getElementById("currentTime-"+t.index).innerHTML=r.default.generateTime(t.timeRemaining),p.style="width: ".concat(t.progress,"%"),p.innerHTML=t.progress+"%",p.className="progress-bar progress-bar-striped bg-".concat(t.progressColour)}else document.getElementById("currentOperationsBody").insertAdjacentHTML("beforeend",'\n                <div id="currentOpCard-'.concat(t.index,'"\n                class="card card-block text-white bg-secondary d-inline-block"\n                style="min-width: 200px; max-width: 200px;"\n              >\n                  <div class="card-header pb-1 pt-1 pl-2 pr-2">\n                     ').concat(t.name,'</div>\n                  <div class="card-body  pb-0 pt-2 pl-2 pr-2">\n                  <h6 id="currentFile-').concat(t.index,'" class="pb-0 text-center" style="font-size:0.6rem;"> ').concat(m,' </h6>\n                  <h6 id="currentRestart-').concat(t.index,'" class="pb-0 text-center d-none" style="font-size:0.6rem;">').concat(f,'</h6>\n                  <h6 id="currentTime-').concat(t.index,'" class="pb-0 text-center" style="font-size:0.6rem;">').concat(r.default.generateTime(t.timeRemaining),'</h6>\n        <h6 id="futureDate-').concat(t.index,'" class="pb-0 text-center" style="font-size:0.6rem;"> ').concat(u,' </h6>\n        <h6 id="finishedPrint-').concat(t.index,'" class="pb-0 text-center d-none" style="font-size:0.6rem;"> ').concat(d,' </h6>\n                    <div id="currentProgressMain-').concat(t.index,'" class="progress">\n                      <div id="currentProgress-').concat(t.index,'"\n                        class="progress-bar progress-bar-striped bg-').concat(t.progressColour,'"\n                        role="progressbar"\n                        style="width: ').concat(t.progress,'%"\n                        aria-valuenow="').concat(t.progress,'"\n                        aria-valuemin="0"\n                        aria-valuemax="100"\n                      >\n                      ').concat(t.progress,"%\n                      </div>\n                    </div>\n                  </div>\n                </div>\n                ")),document.getElementById("currentHarvest-"+t.index).addEventListener("click",(function(e){var n=document.getElementById("currentHarvest-"+t.index).id.split("-");s(n[1])})),document.getElementById("restartCurrentPrint-"+t.index).addEventListener("click",(function(e){var n=document.getElementById("restartCurrentPrint-"+t.index).id.split("-");l(n[1])}));document.getElementById("currentOpCard-"+t.index).style.order=n;var y=document.querySelectorAll("[id^='currentOpCard-']"),g=[];e.forEach((function(e){g.push(e.index)}));var v=[];y.forEach((function(e){var t=e.id.split("-");v.push(t[1])})),_.difference(v,g).forEach((function(e){document.getElementById("currentOpCard-"+e).remove()}))}))};var r=o(e("../functions/calc.js")),a=o(e("../octoprint.js"));function o(e){return e&&e.__esModule?e:{default:e}}function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var c=[],s=function(e){var t=_.findIndex(c,(function(t){return t._id==e}));a.default.file(c[t],c[t].currentJob.filePath,"load")},l=function(e){var t=_.findIndex(c,(function(t){return t._id==e}));a.default.file(c[t],c[t].currentJob.filePath,"print")};document.querySelectorAll("[id^='currentHarvest-']").forEach((function(e){e.addEventListener("click",(function(t){var n=e.id.split("-");s(n[1])}))})),document.querySelectorAll("[id^='restartCurrentPrint-']").forEach((function(e){e.addEventListener("click",(function(t){var n=e.id.split("-");l(n[1])}))}))},{"../functions/calc.js":2,"../octoprint.js":8}],6:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.checkFilamentManager=function(){return c.apply(this,arguments)},n.returnDropDown=function(e){return s.apply(this,arguments)},n.selectFilament=function(e,t,n){return l.apply(this,arguments)};var r,a=(r=e("../octofarm.js"))&&r.__esModule?r:{default:r};function o(e,t,n,r,a,o,i){try{var c=e[o](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,a)}function i(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var i=e.apply(t,n);function c(e){o(i,r,a,c,s,"next",e)}function s(e){o(i,r,a,c,s,"throw",e)}c(void 0)}))}}function c(){return(c=i(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.default.get("settings/server/get");case 2:return t=e.sent,e.next=5,t.json();case 5:return t=e.sent,e.abrupt("return",t.filamentManager);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function s(){return(s=i(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.default.get("filament/get/dropDownList");case 2:return n=e.sent,e.next=5,n.json();case 5:if(n=e.sent,!t){e.next=10;break}return e.abrupt("return",n.selected.historyDropDown);case 10:return e.abrupt("return",n.selected.normalDropDown);case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function l(){return(l=i(regeneratorRuntime.mark((function e(t,n,r){var o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o={tool:r,printerId:t,spoolId:n},e.next=3,a.default.post("filament/select",o);case 3:e.sent;case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},{"../octofarm.js":7}],7:[function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,a;return t=e,a=[{key:"get",value:function(e){var t="/".concat(e);return fetch(t,{method:"GET",headers:{"Content-Type":"application/json"}})}},{key:"delete",value:function(e){var t="/".concat(e);return fetch(t,{method:"DELETE",headers:{"Content-Type":"application/json"}})}},{key:"post",value:function(e,t){var n="/".concat(e);return fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})}}],(n=null)&&r(t.prototype,n),a&&r(t,a),e}();n.default=a},{}],8:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=o(e("./functions/ui.js")),a=o(e("./octofarm.js"));o(e("./functions/validate.js")),e("./modules/filamentGrab.js");function o(e){return e&&e.__esModule?e:{default:e}}function i(e,t,n,r,a,o,i){try{var c=e[o](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,a)}function c(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function c(e){i(o,r,a,c,s,"next",e)}function s(e){i(o,r,a,c,s,"throw",e)}c(void 0)}))}}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var l=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,o,i,l,u,d,f,m,p,y;return t=e,n=null,o=[{key:"post",value:function(e,t,n){var r="".concat(e.printerURL,"/api/").concat(t);return fetch(r,{method:"POST",headers:{"Content-Type":"application/json","X-Api-Key":e.apikey},body:JSON.stringify(n)})}},{key:"folder",value:function(e,t,n){var r="".concat(e.printerURL,"/api/files/").concat(t);return fetch(r,{method:"POST",headers:{"X-Api-Key":e.apikey},body:n})}},{key:"move",value:function(e,t,n){var r="".concat(e.printerURL,"/api/").concat(t);return fetch(r,{method:"POST",headers:{"Content-Type":"application/json","X-Api-Key":e.apikey},body:JSON.stringify(n)})}},{key:"delete",value:function(e,t){var n="".concat(e.printerURL,"/api/").concat(t);return fetch(n,{method:"DELETE",headers:{"Content-Type":"application/json","X-Api-Key":e.apikey}})}},{key:"selectTool",value:(y=c(regeneratorRuntime.mark((function t(n,r){var a;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log(n.printerURL,r),a={command:"select",tool:r},t.next=4,e.post(n,"printer/tool",a);case 4:if(204!==t.sent.status){t.next=9;break}return t.abrupt("return",!0);case 9:return t.abrupt("return",!1);case 10:case"end":return t.stop()}}),t)}))),function(e,t){return y.apply(this,arguments)})},{key:"system",value:(p=c(regeneratorRuntime.mark((function t(n,a){var o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:o="system/commands/core/"+a,bootbox.confirm({message:"Are your sure you want to ".concat(a," ").concat(n.printerName,"?"),buttons:{cancel:{label:'<i class="fa fa-times"></i> No'},confirm:{label:'<i class="fa fa-check"></i> Yes'}},callback:function(t){return c(regeneratorRuntime.mark((function i(){return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(!t){i.next=5;break}return i.next=3,e.post(n,o);case 3:204===i.sent.status?r.default.createAlert("success","".concat(n.printerName,": ").concat(a," was successful"),3e3,"clicked"):r.default.createAlert("error","".concat(n.printerName,": ").concat(a," was unsuccessful. Please make sure printer is connected and commands are setup in Settings -> Server."),3e3,"clicked");case 5:case"end":return i.stop()}}),i)})))()}});case 2:case"end":return t.stop()}}),t)}))),function(e,t){return p.apply(this,arguments)})},{key:"move",value:(m=c(regeneratorRuntime.mark((function t(n,r,a,o,i){var c,s,l,u;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return c=function(){n.target.classList="btn btn-light"},s="printer/printhead",t.next=5,document.querySelectorAll("#pcAxisSteps > .btn.active");case 5:return l=(l=t.sent)[0].innerHTML,u=null,"home"===a?u={command:a,axes:o}:"jog"===a?(l=Number(null!=i?i+l:l),m=l,(f=o)in(d={command:a})?Object.defineProperty(d,f,{value:m,enumerable:!0,configurable:!0,writable:!0}):d[f]=m,u=d):"feedrate"===a&&(u={command:a,factor:l}),t.next=11,e.post(r,s,u);case 11:204===t.sent.status?(n.target.classList="btn btn-success",setTimeout(c,500)):(n.target.classList="btn btn-danger",setTimeout(c,500));case 13:case"end":return t.stop()}var d,f,m}),t)}))),function(e,t,n,r,a){return m.apply(this,arguments)})},{key:"file",value:(f=c(regeneratorRuntime.mark((function t(n,o,i,c){var s,l,u,d,f,m,p;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(s="files/local/"+o,l=null,"load"!==i){t.next=9;break}return u={command:"select",print:!1},t.next=6,e.post(n,s,u);case 6:l=t.sent,t.next=26;break;case 9:if("print"!==i){t.next=22;break}return d={command:"select",print:!0},f={command:"flowrate",factor:parseInt(n.flowRate)},t.next=14,e.post(n,"printer/tool",f);case 14:return m={command:"feedrate",factor:parseInt(n.feedRate)},t.next=17,e.post(n,"printer/printhead",m);case 17:return t.next=19,e.post(n,s,d);case 19:l=t.sent,t.next=26;break;case 22:if("delete"!==i){t.next=26;break}return t.next=25,e.delete(n,s);case 25:l=t.sent;case 26:if(204!==l.status){t.next=38;break}if("delete"!==i){t.next=35;break}return p={i:n,fullPath:o},t.next=31,a.default.post("printers/removefile",p);case 31:t.sent,r.default.createAlert("success","".concat(n.printerName,": ").concat(i," completed"),3e3,"clicked"),t.next=36;break;case 35:r.default.createAlert("success","".concat(n.printerName,": ").concat(i," actioned"),3e3,"clicked");case 36:t.next=39;break;case 38:r.default.createAlert("error","".concat(n.printerName,": ").concat(i," failed"),3e3,"clicked");case 39:case"end":return t.stop()}}),t)}))),function(e,t,n,r){return f.apply(this,arguments)})},{key:"jobAction",value:(d=c(regeneratorRuntime.mark((function t(n,r,o){var i,s,l,u,d;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a.default.get("settings/server/get");case 2:return i=t.sent,t.next=5,i.json();case 5:return i=t.sent,s={command:"flowrate",factor:parseInt(n.flowRate)},t.next=9,e.post(n,"printer/tool",s);case 9:return l={command:"feedrate",factor:parseInt(n.feedRate)},t.next=12,e.post(n,"printer/printhead",l);case 12:if(n._id,u=!1,void 0!==i.filament&&(u=i.filament.filamentCheck),d=!1,null!=n.selectedFilament&&Array.isArray(n.selectedFilament)&&(d=n.selectedFilament.every((function(e){return null!==e}))),!u||d||"start"!==r.command){t.next=21;break}bootbox.confirm({message:"You have spools in the inventory, but none selected. Would you like to select a spool?",buttons:{confirm:{label:"Yes",className:"btn-success"},cancel:{label:"No",className:"btn-danger"}},callback:function(t){return c(regeneratorRuntime.mark((function a(){var i;return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(!t){a.next=3;break}a.next=15;break;case 3:if(null==n.selectedFilament||!Array.isArray(n.selectedFilament)){a.next=9;break}return i={command:"offset",offsets:{}},n.selectedFilament.forEach((function(e,t){null!=e&&(i.offsets["tool"+t]=e.spools.tempOffset)})),a.next=8,e.post(n,"printer/tool",i);case 8:a.sent;case 9:return a.next=11,e.post(n,"printer/printhead",l);case 11:return a.next=13,e.post(n,"job",r);case 13:a.sent,o.target.disabled=!1;case 15:case"end":return a.stop()}}),a)})))()}}),t.next=27;break;case 21:return t.next=23,e.post(n,"printer/printhead",l);case 23:return t.next=25,e.post(n,"job",r);case 25:t.sent,o.target.disabled=!1;case 27:case"end":return t.stop()}}),t)}))),function(e,t,n){return d.apply(this,arguments)})},{key:"connect",value:(u=c(regeneratorRuntime.mark((function t(n,a){var o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=null,o="connect"===n?{command:"connect",port:document.getElementById("pmSerialPort").value,baudrate:parseInt(document.getElementById("pmBaudrate").value),printerProfile:document.getElementById("pmProfile").value,save:!0}:{command:"disconnect"},t.next=4,e.post(a,"connection",o);case 4:204===t.sent.status?(r.default.createAlert("success","".concat(a.printerName,": has ").concat(o.command,"ed successfully."),3e3,"click"),"connect"===n?(document.getElementById("pmSerialPort").disabled=!0,document.getElementById("pmBaudrate").disabled=!0,document.getElementById("pmProfile").disabled=!0):(document.getElementById("pmSerialPort").disabled=!1,document.getElementById("pmBaudrate").disabled=!1,document.getElementById("pmProfile").disabled=!1)):r.default.createAlert("error","".concat(a.printerName,": could not ").concat(o.command,"."),3e3,"click");case 6:case"end":return t.stop()}}),t)}))),function(e,t){return u.apply(this,arguments)})},{key:"power",value:(l=c(regeneratorRuntime.mark((function e(t,n,a,o){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.includes("[PrinterURL]")&&(n=n.replace("[PrinterURL]",t.printerURL)),n.includes("[PrinterAPI]")&&(n=n.replace("[PrinterAPI]",t.apikey)),void 0!==o&&0!==o.length){e.next=9;break}return e.next=5,fetch(n,{method:"POST",headers:{"Content-Type":"application/json"}});case 5:204!==e.sent.status?r.default.createAlert("error","".concat(t.printerName,": Could not complete ").concat(a),3e3):r.default.createAlert("success","".concat(t.printerName,": Successfully completed ").concat(a),3e3),e.next=13;break;case 9:return e.next=11,fetch(n,{method:"POST",headers:{"Content-Type":"application/json","X-Api-Key":t.apikey},body:o});case 11:204!==e.sent.status?r.default.createAlert("error","".concat(t.printerName,": Could not complete ").concat(a),3e3):r.default.createAlert("success","".concat(t.printerName,": Successfully completed ").concat(a),3e3);case 13:return e.abrupt("return","done");case 14:case"end":return e.stop()}}),e)}))),function(e,t,n,r){return l.apply(this,arguments)})},{key:"getPowerStatus",value:(i=c(regeneratorRuntime.mark((function e(t,n,r){var a,o,i,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.includes("[PrinterURL]")&&(n=n.replace("[PrinterURL]",t.printerURL)),n.includes("[PrinterAPI]")&&(n=n.replace("[PrinterAPI]",t.apikey)),void 0!==r&&""!=r){e.next=16;break}return e.next=5,fetch(n,{method:"POST",headers:{"Content-Type":"application/json"}});case 5:if(200===(a=e.sent).status&&204===a.status){e.next=10;break}return e.abrupt("return","No Status");case 10:return e.next=12,a.json();case 12:return a=e.sent,e.abrupt("return",a);case 14:e.next=32;break;case 16:return e.prev=16,e.next=19,fetch(n,{method:"POST",headers:{"Content-Type":"application/json","X-Api-Key":t.apikey},body:r});case 19:if(o=e.sent,i="No Status",200!==o.status&&204!==o.status){e.next=25;break}return e.next=24,o.json();case 24:i=e.sent;case 25:(c=document.getElementById("printerStatus-"+t._id))&&("No Status"===i?c.style.color="black":i[Object.keys(i)[0]]?c.style.color="green":c.style.color="red"),e.next=32;break;case 29:e.prev=29,e.t0=e.catch(16),console.log("Printer Power Check failed... classing offline:",e.t0);case 32:case"end":return e.stop()}}),e,null,[[16,29]])}))),function(e,t,n){return i.apply(this,arguments)})}],n&&s(t.prototype,n),o&&s(t,o),e}();n.default=l},{"./functions/ui.js":3,"./functions/validate.js":4,"./modules/filamentGrab.js":6,"./octofarm.js":7}]},{},[1]);
//# sourceMappingURL=dashboardRunner.min.js.map
