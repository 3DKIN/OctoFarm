!function e(t,n,r){function a(o,c){if(!n[o]){if(!t[o]){var s="function"==typeof require&&require;if(!c&&s)return s(o,!0);if(i)return i(o,!0);var l=new Error("Cannot find module '"+o+"'");throw l.code="MODULE_NOT_FOUND",l}var u=n[o]={exports:{}};t[o][0].call(u.exports,(function(e){return a(t[o][1][e]||e)}),u,u.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)a(r[o]);return a}({1:[function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,a;return t=e,a=[{key:"randomString",value:function(){return Math.random().toString(36).substr(2,5)}},{key:"toFixed",value:function(e,t){return null!=e?e.toFixed(t):0}},{key:"generateTime",value:function(e){var t="";if(void 0===e||isNaN(e)||null===e)t="No Time Estimate";else{Math.floor(e/131400);var n=Math.floor(e/86400);e-=3600*n*24;var r=Math.floor(e/3600);e-=3600*r;var a=Math.floor(e/60);e-=60*a,e=Math.floor(e),t="".concat(n,"d, ").concat(r,"h, ").concat(a,"m, ").concat(e,"s"),0===a&&t.includes("0m")&&(t=t.replace(" 0m,","")),0===r&&t.includes("0h")&&(t=t.replace(" 0h,","")),0===n&&t.includes("0d")&&(t=t.replace("0d,","")),0===a&&0===r&&0===n&&0===e&&(t=t.replace("0s","Done"))}return t}},{key:"isBetween",value:function(e,t,n){return(e-t)*(e-n)<=0}},{key:"returnPrintCost",value:function(e,t){if(void 0===e)return"No cost settings to calculate from";var n=t/3600,r=parseFloat(e.powerConsumption)*parseFloat(e.electricityCosts)*n,a=parseFloat(e.purchasePrice),i=parseFloat(e.estimateLifespan);return(r+((i>0?a/i:0)+parseFloat(e.maintenanceCosts))*n).toFixed(2)}},{key:"bytes",value:function(e,t){if(void 0===e||isNaN(e)||null===e)return"No File Estimate";if(0==e)return"0 Bytes";var n=t||2,r=Math.floor(Math.log(e)/Math.log(1024));return"".concat(parseFloat((e/Math.pow(1024,r)).toFixed(n))," ").concat(["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"][r])}},{key:"dateClean",value:function(e){return e=new Date(e),"".concat(["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][e.getDay()]," ").concat(["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][e.getMonth()]," ").concat(e.getFullYear()," - ").concat(e.getHours(),":").concat(e.getMinutes(),":").concat(e.getSeconds())}}],(n=null)&&r(t.prototype,n),a&&r(t,a),e}();n.default=a},{}],2:[function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,a;return t=e,a=[{key:"getColour",value:function(e){return"Operational"===e?{name:"secondary",hex:"#262626",category:"Idle"}:"Paused"===e?{name:"warning",hex:"#583c0e",category:"Idle"}:"Printing"===e||"Pausing"===e||"Cancelling"===e?{name:"warning",hex:"#583c0e",category:"Active"}:"Error"===e?{name:"danger",hex:"#2e0905",category:"Idle"}:"Offline"===e?{name:"danger",hex:"#2e0905",category:"Offline"}:"Searching..."===e?{name:"danger",hex:"#2e0905",category:"Idle"}:"Closed"===e?{name:"danger",hex:"#2e0905",category:"Closed"}:"Complete"===e?{name:"success",hex:"#00330e",category:"Complete"}:{name:"danger",hex:"#2e0905",category:"Offline"}}},{key:"createMessage",value:function(e,t){var n=document.getElementById(t),r='\n      <div class="alert alert-'.concat(e.type,' alert-dismissible fade show" role="alert">\n        ').concat(e.msg,'\n      <button type="button" class="close" data-dismiss="alert" aria-label="Close">\n        <span aria-hidden="true">&times;</span>\n      </button>\n    </div>\n    ');n.insertAdjacentHTML("beforeend",r)}},{key:"createAlert",value:function(e,t,n,r){r=null!=r?["click"]:[],Noty.setMaxVisible(50),new Noty({type:e,theme:"bootstrap-v4",closeWith:r,timeout:n,layout:"bottomRight",text:t}).show()}},{key:"doesElementNeedUpdating",value:function(e,t,n){JSON.stringify(e)!==JSON.stringify(t[n])&&(t[n]=e)}},{key:"clearSelect",value:function(e){document.querySelectorAll("*[id^="+e+"]").forEach((function(e){e.value=""}))}},{key:"addSelectListeners",value:function(e){document.querySelectorAll("*[id^="+e+"]").forEach((function(e){e.addEventListener("focus",(function(t){e.value!==e.placeholder&&(e.value=e.placeholder)})),e.addEventListener("focusout",(function(t){e.value!==e.placeholder&&(e.placeholder=e.value)}))}))}}],(n=null)&&r(t.prototype,n),a&&r(t,a),e}();n.default=a},{}],3:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=i(e("../functions/ui.js")),a=i(e("../octofarm.js"));function i(e){return e&&e.__esModule?e:{default:e}}function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(){var e=function(e,t){t||(t=e.slice(0));return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(['\n                           <tr class="d-none">\n\n                </td>\n                <td>  \n                </td>\n                <td>  \n\n                </td> \n                <td>    \n                    No Alerts Found\n                </td>\n                <td>    \n\n                </td>\n                <td>\n\n                </td>\n                </tr>']);return c=function(){return e},e}function s(e,t,n,r,a,i,o){try{var c=e[i](o),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,a)}function l(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var i=e.apply(t,n);function o(e){s(i,r,a,o,c,"next",e)}function c(e){s(i,r,a,o,c,"throw",e)}o(void 0)}))}}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var d='\n                                                         <option selected value="0">Choose...</option>\n                                                            <option value="done">Print Done</option>\n                                                            <option value="failed">Print Failed</option>\n                                                            <option value="paused">Print Paused</option>\n                                                            <option value="cooldown">Print Cooled</option>\n                                                            <option value="error">Print Error</option>\n',m=document.getElementById("testScript");m&&m.addEventListener("click",(function(e){e.preventDefault(),e.stopPropagation();var t=p.grabPage(),n=p.checkPage(t);n.length>0?(r.default.createAlert("warning","There are issues with your input, please correct the highlighted fields",3e3,"Clicked"),n.forEach((function(e){"script"===e&&(t.script.style.borderColor="red"),"message"===e&&(t.message.style.borderColor="red"),"trigger"===e&&(t.trigger.style.borderColor="red")}))):(t.script.style.borderColor="green",t.message.style.borderColor="green",t.trigger.style.borderColor="green",p.test(t.script.value,t.message.value))}));var f=document.getElementById("alertsTrigger");f&&f.insertAdjacentHTML("beforeend",d);var g=document.getElementById("saveScript");g&&g.addEventListener("click",(function(e){e.preventDefault(),e.stopPropagation();var t=p.grabPage(),n=p.checkPage(t);if(n.length>0)r.default.createAlert("warning","There are issues with your input, please correct the highlighted fields",3e3,"Clicked"),n.forEach((function(e){"script"===e&&(t.script.style.borderColor="red"),"message"===e&&(t.message.style.borderColor="red"),"trigger"===e&&(t.trigger.style.borderColor="red")}));else{t.script.style.borderColor="green",t.message.style.borderColor="green",t.trigger.style.borderColor="green";var a={active:!0,trigger:t.trigger.value,script:t.script.value,message:t.message.value};p.save(a)}}));var p=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i,s,m,f,g,p,y,h;return t=e,n=null,i=[{key:"alertsDrop",value:(h=l(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",d);case 1:case"end":return e.stop()}}),e)}))),function(){return h.apply(this,arguments)})},{key:"get",value:(y=l(regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a.default.get("scripts/get");case 2:return n=t.sent,t.next=5,n.json();case 5:n=t.sent,(r=document.getElementById("alertsTable")).innerHTML="",200===n.status?n.alerts.forEach((function(t){0===t.printer.length&&(t.printer="All Printers"),r.insertAdjacentHTML("beforeend",'\n                <tr id="alertList-'.concat(t._id,'">\n                <td class="d-none">\n                    ').concat(t._id,'\n                </td>\n                <td> \n                 <form class="was-validated">\n                      <div class="custom-control custom-checkbox mb-3">\n                            <input type="checkbox" class="custom-control-input" id="active-').concat(t._id,'" required>\n                            <label class="custom-control-label" for="active-').concat(t._id,'"></label>\n\n                        </div>\n                    </form>\n                </td>\n                <td>  \n                      <select class="custom-select" id="trigger-').concat(t._id,'" disabled>\n\n                       </select>\n                </td> \n                <td >    \n                        <div id="scriptLocation-').concat(t._id,'" contenteditable="false"> ').concat(t.scriptLocation,'  </div>\n                </td>\n                <td>    \n                        <div  id="message-').concat(t._id,'" contenteditable="false"> ').concat(t.message,'</div>\n                </td>\n                <td id="printers-').concat(t._id,'">\n                        ').concat(t.printer,'\n                </td>\n                 <td>\n                    <button id="edit-').concat(t._id,'" type="button" class="btn btn-sm btn-info edit">\n                    <i class="fas fa-edit editIcon"></i>\n                  </button>\n                  <button id="save-').concat(t._id,'" type="button" class="btn btn-sm d-none btn-success save">\n                    <i class="fas fa-save saveIcon"></i>\n                  </button>\n                  <button id="delete-').concat(t._id,'" type="button" class="btn btn-sm btn-danger delete">\n                    <i class="fas fa-trash deleteIcon"></i>\n                  </button>\n                </td>\n                </tr>\n           '));var n=document.getElementById("trigger-"+t._id);n.innerHTML=d,n.value=t.trigger,document.getElementById("active-"+t._id).checked=t.active,document.getElementById("edit-"+t._id).addEventListener("click",(function(n){e.edit(t._id)})),document.getElementById("save-"+t._id).addEventListener("click",(function(n){var r={active:document.getElementById("active-"+t._id).checked,trigger:document.getElementById("trigger-"+t._id).value,script:document.getElementById("scriptLocation-"+t._id).innerHTML.trim(),message:document.getElementById("message-"+t._id).innerHTML.trim()};e.saveEdit(t._id,r)})),document.getElementById("delete-"+t._id).addEventListener("click",(function(n){e.delete(t._id)}))})):r.insertAdjacentHTML("beforeend"(c()));case 9:case"end":return t.stop()}}),t)}))),function(){return y.apply(this,arguments)})},{key:"edit",value:(p=l(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:document.getElementById("alertList-"+t).querySelectorAll("[contenteditable]").forEach((function(e){e.contentEditable=!0,e.classList.add("contentEditable")})),document.getElementById("save-"+t).classList.remove("d-none"),document.getElementById("edit-"+t).classList.add("d-none"),document.getElementById("trigger-"+t).disabled=!1;case 6:case"end":return e.stop()}}),e)}))),function(e){return p.apply(this,arguments)})},{key:"saveEdit",value:(g=l(regeneratorRuntime.mark((function t(n,i){var o,c;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o={id:n,active:i.active,trigger:i.trigger,scriptLocation:i.script,message:i.message},t.next=3,a.default.post("scripts/edit",o);case 3:return c=t.sent,t.next=6,c.json();case 6:200!==(c=t.sent).status?r.default.createAlert("error","Failed to save your alert!",3e3,"Clicked"):(r.default.createAlert("success","Successfully saved your alert!",3e3,"Clicked"),e.get()),document.getElementById("alertList-"+n).querySelectorAll("[contenteditable]").forEach((function(e){e.contentEditable=!1,e.classList.remove("contentEditable")})),document.getElementById("save-"+n).classList.add("d-none"),document.getElementById("edit-"+n).classList.remove("d-none"),document.getElementById("trigger-"+n).disabled=!0;case 14:case"end":return t.stop()}}),t)}))),function(e,t){return g.apply(this,arguments)})},{key:"save",value:(f=l(regeneratorRuntime.mark((function t(n){var i,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i={active:n.active,trigger:n.trigger,scriptLocation:n.script,message:n.message,printer:[]},t.next=3,a.default.post("scripts/save",i);case 3:return o=t.sent,t.next=6,o.json();case 6:200!==(o=t.sent).status?r.default.createAlert("error","Failed to save your alert!",3e3,"Clicked"):(r.default.createAlert("success","Successfully saved your alert!",3e3,"Clicked"),e.get());case 8:case"end":return t.stop()}}),t)}))),function(e){return f.apply(this,arguments)})},{key:"delete",value:(m=l(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.default.delete("scripts/delete/"+t);case 2:return n=e.sent,e.next=5,n.json();case 5:200===(n=e.sent).status?(r.default.createAlert("error","Failed to delete your alert.",3e3,"Clicked"),document.getElementById("alertList-"+t).remove()):r.default.createAlert("success","Successfully deleted your alert.",3e3,"Clicked");case 7:case"end":return e.stop()}}),e)}))),function(e){return m.apply(this,arguments)})},{key:"test",value:(s=l(regeneratorRuntime.mark((function e(t,n){var i,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i={scriptLocation:t,message:n},e.next=3,a.default.post("scripts/test",i);case 3:return c=e.sent,e.next=6,c.json();case 6:"object"===o((c=e.sent).testFire)?r.default.createAlert("error",c.testFire.stderr,3e3,"Clicked"):r.default.createAlert("success",c.testFire,3e3,"Clicked");case 8:case"end":return e.stop()}}),e)}))),function(e,t){return s.apply(this,arguments)})},{key:"checkPage",value:function(e){var t=[];return""===e.script.value&&t.push("script"),"0"===e.trigger.value&&t.push("trigger"),""===e.message.value&&t.push("message"),t}},{key:"grabPage",value:function(){return{trigger:document.getElementById("alertsTrigger"),script:document.getElementById("scriptLocation"),message:document.getElementById("scriptMessage")}}}],n&&u(t.prototype,n),i&&u(t,i),e}();n.default=p},{"../functions/ui.js":2,"../octofarm.js":4}],4:[function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,a;return t=e,a=[{key:"get",value:function(e){var t="/".concat(e);return fetch(t,{method:"GET",headers:{"Content-Type":"application/json"}})}},{key:"delete",value:function(e){var t="/".concat(e);return fetch(t,{method:"DELETE",headers:{"Content-Type":"application/json"}})}},{key:"post",value:function(e,t){var n="/".concat(e);return fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})}}],(n=null)&&r(t.prototype,n),a&&r(t,a),e}();n.default=a},{}],5:[function(e,t,n){"use strict";var r=c(e("./lib/octofarm.js")),a=c(e("./lib/functions/ui.js")),i=c(e("./lib/functions/calc.js")),o=c(e("./lib/modules/scriptCheck.js"));function c(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t,n){return t&&l(e.prototype,t),n&&l(e,n),e}function d(e,t,n,r,a,i,o){try{var c=e[i](o),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,a)}function m(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var i=e.apply(t,n);function o(e){d(i,r,a,o,c,"next",e)}function c(e){d(i,r,a,o,c,"throw",e)}o(void 0)}))}}document.getElementById("saveServerSettings").addEventListener("click",(function(e){b.update()})),document.getElementById("saveSettings").addEventListener("click",(function(e){v.update()})),document.getElementById("nukeEverything").addEventListener("click",(function(e){b.nukeDatabases("nukeEverything")})),document.getElementById("nukeAlerts").addEventListener("click",(function(e){b.nukeDatabases("AlertsDB")})),document.getElementById("nukeClientSettings").addEventListener("click",(function(e){b.nukeDatabases("ClientSettingsDB")})),document.getElementById("nukeFilament").addEventListener("click",(function(e){b.nukeDatabases("FilamentDB")})),document.getElementById("nukeHistory").addEventListener("click",(function(e){b.nukeDatabases("HistoryDB")})),document.getElementById("nukePrinters").addEventListener("click",(function(e){b.nukeDatabases("PrintersDB")})),document.getElementById("nukeRoomData").addEventListener("click",(function(e){b.nukeDatabases("roomDataDB")})),document.getElementById("nukeServerSettings").addEventListener("click",(function(e){b.nukeDatabases("ServerSettingsDB")})),document.getElementById("nukeUsers").addEventListener("click",(function(e){b.nukeDatabases("UserDB")})),document.getElementById("resetDashboardBtn").addEventListener("click",(function(e){var t=localStorage.getItem("dashboardConfiguration"),n=JSON.parse(t);null!==n&&0!==n.length&&localStorage.removeItem("dashboardConfiguration"),a.default.createAlert("success","Dashboard data cleared from browser",3e3,"clicked")}));var f={},g={title:{text:"Memory",align:"center",margin:1,offsetX:0,offsetY:0,floating:!1,style:{fontSize:"14px",fontWeight:"bold",fontFamily:void 0,color:"#fff"}},chart:{type:"donut",height:"100%",width:"100%",animations:{enabled:!1},background:"#303030"},theme:{mode:"dark"},plotOptions:{pie:{expandOnClick:!0,dataLabels:{offset:10,minAngleToShowLabel:15}}},stroke:{show:!1},tooltip:{y:{formatter:function(e){return i.default.bytes(e)}}},noData:{text:"Loading..."},dataLabels:{enabled:!1},series:[],labels:["Other","OctoFarm","Free"],colors:["#f39c12","#3498db","#00bc8c"],legend:{show:!0,showForSingleSeries:!1,showForNullSeries:!0,showForZeroSeries:!0,position:"bottom",horizontalAlign:"center",floating:!1,fontSize:"11px",fontFamily:"Helvetica, Arial",fontWeight:400,formatter:void 0,inverseOrder:!1,width:void 0,height:void 0,tooltipHoverFormatter:void 0,offsetX:-25,offsetY:0,labels:{colors:void 0,useSeriesColors:!1},markers:{width:9,height:9,strokeWidth:0,strokeColor:"#fff",fillColors:void 0,radius:1,customHTML:void 0,onClick:void 0,offsetX:0,offsetY:0},itemMargin:{horizontal:1,vertical:0},onItemClick:{toggleDataSeries:!1},onItemHover:{highlightDataSeries:!1}}},p={title:{text:"CPU",align:"center",margin:1,offsetX:0,offsetY:0,floating:!1,style:{fontSize:"14px",fontWeight:"bold",fontFamily:void 0,color:"#fff"}},chart:{type:"donut",height:"100%",width:"100%",animations:{enabled:!0},background:"#303030"},theme:{mode:"dark"},plotOptions:{pie:{expandOnClick:!1,dataLabels:{offset:10,minAngleToShowLabel:15}}},stroke:{show:!1},tooltip:{y:{formatter:function(e){return"".concat(Math.round(10*e)/10,"%")}}},noData:{text:"Loading..."},dataLabels:{enabled:!1},series:[],labels:["System","OctoFarm","User","Free"],colors:["#f39c12","#3498db","#375a7f","#00bc8c"],legend:{show:!0,showForSingleSeries:!1,showForNullSeries:!0,showForZeroSeries:!0,position:"bottom",horizontalAlign:"center",floating:!1,fontSize:"11px",fontFamily:"Helvetica, Arial",fontWeight:400,formatter:void 0,inverseOrder:!1,width:void 0,height:void 0,tooltipHoverFormatter:void 0,offsetX:-25,offsetY:0,labels:{colors:void 0,useSeriesColors:!1},markers:{width:9,height:9,strokeWidth:0,strokeColor:"#fff",fillColors:void 0,radius:1,customHTML:void 0,onClick:void 0,offsetX:0,offsetY:0},itemMargin:{horizontal:1,vertical:0},onItemClick:{toggleDataSeries:!1},onItemHover:{highlightDataSeries:!1}}},y=new ApexCharts(document.querySelector("#systemChartCPU"),p);y.render();var h=new ApexCharts(document.querySelector("#systemChartMemory"),g);h.render(),setInterval(function(){var e=m(regeneratorRuntime.mark((function e(){var t,n,a,o,c,s,l,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.default.get("settings/sysInfo");case 2:return t=e.sent,e.next=5,t.json();case 5:t=e.sent,0===Object.keys(t).length&&t.constructor===Object||(document.getElementById("systemUptime").innerHTML=i.default.generateTime(t.sysUptime.uptime),document.getElementById("processUpdate").innerHTML=i.default.generateTime(t.processUptime),n=t.cpuLoad.currentload_system,a=t.sysProcess.pcpu,o=t.cpuLoad.currentload_user,c=n+a+o,y.updateSeries([n,a,o,100-c]),s=t.memoryInfo.total-t.memoryInfo.free,l=t.memoryInfo.total/100*t.sysProcess.pmem,u=t.memoryInfo.free,h.updateSeries([s,l,u]));case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),5e3);var v=function(){function e(){s(this,e)}var t;return u(e,null,[{key:"init",value:function(){r.default.get("settings/client/get").then((function(e){return e.json()})).then((function(e){document.getElementById("panelCurrentOpOn").checked=e.panelView.currentOp,document.getElementById("panelHideOffline").checked=e.panelView.hideOff,document.getElementById("panelHideClosed").checked=e.panelView.hideClosed,document.getElementById("panelExtraInfoOn").checked=e.panelView.extraInfo,document.getElementById("selectCameraGrid").value=e.cameraView.cameraRows,void 0!==e.dashboard&&(document.getElementById("currentOperations").checked=e.dashboard.farmActivity.currentOperations,document.getElementById("cumulativeTimes").checked=e.dashboard.farmActivity.cumulativeTimes,document.getElementById("averageTimes").checked=e.dashboard.farmActivity.averageTimes,document.getElementById("printerState").checked=e.dashboard.printerStates.printerState,document.getElementById("printerTemps").checked=e.dashboard.printerStates.printerProgress,document.getElementById("printerUtilisation").checked=e.dashboard.printerStates.printerUtilisation,document.getElementById("printerProgress").checked=e.dashboard.printerStates.printerProgress,document.getElementById("currentStatus").checked=e.dashboard.printerStates.currentStatus,document.getElementById("currentUtilisation").checked=e.dashboard.farmUtilisation.currentUtilisation,document.getElementById("farmUtilisation").checked=e.dashboard.farmUtilisation.farmUtilisation,document.getElementById("weeklyUtilisation").checked=e.dashboard.historical.weeklyUtilisation,document.getElementById("hourlyTotalTemperatures").checked=e.dashboard.historical.hourlyTotalTemperatures,document.getElementById("environmentalHistory").checked=e.dashboard.historical.environmentalHistory)}))}},{key:"update",value:(t=m(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={panelView:{currentOp:document.getElementById("panelCurrentOpOn").checked,hideOff:document.getElementById("panelHideOffline").checked,hideClosed:document.getElementById("panelHideClosed").checked,extraInfo:document.getElementById("panelExtraInfoOn").checked},cameraView:{cameraRows:document.getElementById("selectCameraGrid").value},dashboard:{defaultLayout:[{x:0,y:0,width:2,height:5,id:"currentUtil"},{x:5,y:0,width:3,height:5,id:"farmUtil"},{x:8,y:0,width:2,height:5,id:"averageTimes"},{x:10,y:0,width:2,height:5,id:"cumulativeTimes"},{x:2,y:0,width:3,height:5,id:"currentStat"},{x:6,y:5,width:3,height:5,id:"printerTemps"},{x:9,y:5,width:3,height:5,id:"printerUtilisation"},{x:0,y:5,width:3,height:5,id:"printerStatus"},{x:3,y:5,width:3,height:5,id:"printerProgress"},{x:6,y:10,width:6,height:9,id:"hourlyTemper"},{x:0,y:10,width:6,height:9,id:"weeklyUtil"},{x:0,y:19,width:12,height:8,id:"enviroData"}],savedLayout:localStorage.getItem("dashboardConfiguration"),farmActivity:{currentOperations:document.getElementById("currentOperations").checked,cumulativeTimes:document.getElementById("cumulativeTimes").checked,averageTimes:document.getElementById("averageTimes").checked},printerStates:{printerState:document.getElementById("printerState").checked,printerTemps:document.getElementById("printerTemps").checked,printerUtilisation:document.getElementById("printerUtilisation").checked,printerProgress:document.getElementById("printerProgress").checked,currentStatus:document.getElementById("currentStatus").checked},farmUtilisation:{currentUtilisation:document.getElementById("currentUtilisation").checked,farmUtilisation:document.getElementById("farmUtilisation").checked},historical:{weeklyUtilisation:document.getElementById("weeklyUtilisation").checked,hourlyTotalTemperatures:document.getElementById("hourlyTotalTemperatures").checked,environmentalHistory:document.getElementById("environmentalHistory").checked}}},e.next=3,r.default.post("settings/client/update",t);case 3:localStorage.setItem("clientSettings",JSON.stringify(t)),a.default.createAlert("success","Client settings updated",3e3,"clicked");case 5:case"end":return e.stop()}}),e)}))),function(){return t.apply(this,arguments)})},{key:"get",value:function(){}}]),e}(),b=function(){function e(){s(this,e)}var t;return u(e,null,[{key:"nukeDatabases",value:function(e){r.default.get("settings/server/delete/database/"+e).then((function(e){return e.json()})).then((function(e){a.default.createAlert("success",e.message,3e3)}))}},{key:"init",value:(t=m(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.default.get("settings/server/get").then((function(e){return e.json()})).then((function(e){if(f=e,document.getElementById("webSocketThrottle").value=e.onlinePolling.seconds,document.getElementById("serverPortNo").value=e.server.port,document.getElementById("requireLogin").checked=e.server.loginRequired,document.getElementById("requireRegistration").checked=e.server.registration,document.getElementById("webSocketRetry").value=e.timeout.webSocketRetry/1e3,document.getElementById("APITimeout").value=e.timeout.apiTimeout/1e3,document.getElementById("APIRetryTimeout").value=e.timeout.apiRetryCutoff/1e3,document.getElementById("APIRetry").value=e.timeout.apiRetry/1e3,void 0!==e.filament&&(document.getElementById("checkFilament").checked=e.filament.filamentCheck),e.filamentManager){if(e.filamentManager){var t=document.getElementById("resync-FilamentManager");t.addEventListener("click",function(){var e=m(regeneratorRuntime.mark((function e(n){var a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.disabled=!0,t.innerHTML='<i class="fas fa-sync fa-spin"></i> <br> Syncing... <br> Please Wait...',e.next=4,r.default.post("filament/filamentManagerReSync");case 4:return a=e.sent,e.next=7,a.json();case 7:(a=e.sent).status,t.innerHTML='<i class="fas fa-sync"></i> <br> Re-Sync Database',t.disabled=!1;case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),document.getElementById("disable-FilamentManager").addEventListener("click",function(){var e=m(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.default.post("filament/disableFilamentPlugin",{activate:!0});case 2:return n=e.sent,e.next=5,n.json();case 5:n=e.sent;case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}}else{var n=document.getElementById("filamentManagerSyncBtn");n.addEventListener("click",function(){var e=m(regeneratorRuntime.mark((function e(t){var i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.innerHTML='<i class="fas fa-sync fa-spin"></i> <br> Syncing <br> Please Wait...',e.next=3,r.default.post("filament/filamentManagerSync",{activate:!0});case 3:return i=e.sent,e.next=6,i.json();case 6:(i=e.sent).status?(n.innerHTML='<i class="fas fa-sync"></i> <br> Sync Filament Manager',n.disabled=!0,a.default.createAlert("success","Filament Manager Plugin successfully synced",3e3)):(n.innerHTML='<i class="fas fa-sync"></i> <br> Sync Filament Manager',n.disabled=!1,a.default.createAlert("error","Something went wrong, please check the filament manager logs.",3e3));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}})),e.next=3,r.default.get("settings/server/get/logs");case 3:return t=e.sent,e.next=6,t.json();case 6:t=e.sent,n=document.getElementById("serverLogs"),t.forEach((function(e){n.insertAdjacentHTML("beforeend","\n            <tr>\n                <td>".concat(e.name,"</td>\n                <td>").concat(new Date(e.modified).toString().substring(0,21),"</td>\n                <td>").concat(i.default.bytes(e.size),'</td>\n                <td><button id="').concat(e.name,'" type="button" class="btn btn-sm btn-primary"><i class="fas fa-download"></i></button></td>\n            </tr>\n        ')),document.getElementById(e.name).addEventListener("click",function(){var t=m(regeneratorRuntime.mark((function t(n){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.name,window.open("/settings/server/download/logs/".concat(e.name));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}));case 9:case"end":return e.stop()}}),e)}))),function(){return t.apply(this,arguments)})},{key:"update",value:function(){var e=!1,t={seconds:document.getElementById("webSocketThrottle").value},n={port:parseInt(document.getElementById("serverPortNo").value),loginRequired:document.getElementById("requireLogin").checked,registration:document.getElementById("requireRegistration").checked},i={webSocketRetry:1e3*document.getElementById("webSocketRetry").value,apiTimeout:1e3*document.getElementById("APITimeout").value,apiRetryCutoff:1e3*document.getElementById("APIRetryTimeout").value,apiRetry:1e3*document.getElementById("APIRetry").value},o={filamentCheck:document.getElementById("checkFilament").checked};f.server.port===n.port&&f.server.loginRequired===n.loginRequired&&f.server.registration===n.registration&&f.timeout.webSocketRetry===i.webSocketRetry&&f.timeout.apiTimeout===i.apiTimeout&&f.timeout.apiRetryCutoff===i.apiRetryCutoff&&f.timeout.apiRetry===i.apiRetry||(e=!0),r.default.post("settings/server/update",{onlinePolling:t,server:n,timeout:i,filament:o}).then((function(e){return e.json()})).then((function(t){e&&bootbox.confirm({message:"Your settings changes require a restart, would you like to do this now?",buttons:{cancel:{label:'<i class="fa fa-times"></i> Cancel'},confirm:{label:'<i class="fa fa-check"></i> Confirm'}},callback:function(e){e&&(r.default.get("settings/server/restart"),a.default.createAlert("warning","Performing a server restart, please wait for it to come back online.",6e3,"Clicked"))}})}))}}]),e}();b.init(),v.init(),o.default.get();var k=GridStack.init({animate:!0,cellHeight:30,draggable:{handle:".tag"},float:!0});!function(){var e=localStorage.getItem("dashboardConfiguration"),t=JSON.parse(e);if(null!==t&&0!==t.length){var n=GridStack.Utils.sort(t);k.batchUpdate(),k.engine.nodes.forEach((function(e){var t=n.find((function(t){return t.id===e.id}));void 0!==t&&k.update(e.el,t.x,t.y,t.width,t.height)})),k.commit()}}(),k.on("change",(function(e,t){var n;n=[],k.engine.nodes.forEach((function(e){n.push({x:e.x,y:e.y,width:e.width,height:e.height,id:e.id})})),localStorage.setItem("dashboardConfiguration",JSON.stringify(n))}))},{"./lib/functions/calc.js":1,"./lib/functions/ui.js":2,"./lib/modules/scriptCheck.js":3,"./lib/octofarm.js":4}]},{},[5]);
//# sourceMappingURL=settings.min.js.map
